# ReLOAD

Implementation of our TIFS paper

 "ReLOAD: Using Reinforcement Learning to Optimize Asymmetric Distortion for Additive Steganography"

 This program is stable under Python=3.5!

 We recommend that using conda before installing all the requirements. The details of our local conda environment are in:

 - environment.yaml

 If your local dependencies are the same as us, then you can run this command to setup your environment:

 - conda env create -f environment.yaml

 If not, you can first create a python3.5 environment and running this command:

 - pip install -r requirement.txt




 Directories and files included in the implementation:

 'models' - The well-trained ReLOAD models. For example, 'model/ReLOAD_HILL_04.npz' is the ReLOAD_HILL model with the payload of 0.4 BPP.

 'samples/cover' - 6 cover images, which can be used to run a sample test of ReLOAD with its well-trained models.

 'samples/HILL(MiPOD)_04' - 6 stego images embedded by additive and symmetric methods including HILL and MiPOD with the payload of 0.4 BPP.
 
 'samples/Rho_HILL(MiPOD)04' - 6 distortion maps generated by additive and symmetric methods including HILL and MiPOD with the payload of 0.4 BPP.

 'samples/stego_ReLOAD_HILL(MiPOD)_m_0.18_p_0.4' - 6 stego images embedded by the additive and asymmetric distortion optimized by our proposed ReLOAD including HILL and MiPOD with the payload of 0.4 BPP.
 
 'samples/diff_ReLOAD_HILL(MiPOD)_04' - 6 modification maps of our proposed ReLOAD based on HILL or MiPOD with the payload of 0.4 BPP.
 'alaska1_train.txt' - alaska1_train.txt is composed of the path of images in the training dataset of ALASKA1.
 'alaska1_val.txt' - alaska1_val.txt is composed of the path of images in the validating dataset of ALASKA1.
 'samples.txt' - samples.txt is composed of the path of images in ./sample/cover. To run asymmetric distortion optimization for your dataset, you can generate the txt file with the same format of samples.txt.

 


 To run training or testing procedures of ReLOAD, these following parameters in train.py and test.py should be first introduced:

  --payload(-p): embedding payload 
  
  --ear(-m): efficient agent rate which is set to 0.18 in this paper
  
  --model_path(-path): the path of the ReLOAD model utilized for loading

 The commands for training and testing are:
 - Training:
 - CUDA_VISIBLE_DEVICES=0 python train.py -p your_payload_rate -m 0.18 
 - Testing:
 - CUDA_VISIBLE_DEVICES=0 python test.py -p your_payload_rate -m 0.18 -path ./model/ReLOAD_MiPOD_04.npz
